<!DOCTYPE html>
<html class="light h-full" lang="id">
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Daftar Kafe - SurabayaCafeFinder</title>

    <script src="https://cdn.tailwindcss.com?plugins=forms,container-queries"></script>

    <link rel="preconnect" href="https://fonts.googleapis.com" />
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin />
    <link
      href="https://fonts.googleapis.com/css2?family=Plus+Jakarta+Sans:wght@400;500;700;800&display=swap"
      rel="stylesheet"
    />
    <link
      href="https://fonts.googleapis.com/css2?family=Material+Symbols+Outlined:opsz,wght,FILL,GRAD@20..48,100..700,0..1,0..200"
      rel="stylesheet"
    />

    <link
      rel="stylesheet"
      href="https://unpkg.com/leaflet@1.9.4/dist/leaflet.css"
    />

    <style>
      #map {
        width: 100%;
        height: 100%;
        border-radius: 0.5rem;
      }
      .material-symbols-outlined {
        font-variation-settings: "FILL" 0, "wght" 400, "GRAD" 0, "opsz" 24;
      }
      #cafe-list::-webkit-scrollbar {
        width: 6px;
      }
      #cafe-list::-webkit-scrollbar-thumb {
        background-color: rgba(161, 98, 7, 0.2);
        border-radius: 10px;
      }
    </style>

    <script>
      tailwind.config = {
        darkMode: "class",
        theme: {
          extend: {
            colors: {
              primary: "#A16207",
              "background-light": "#FEFCE8",
              "background-dark": "#1F2937",
              secondary: "#FDE68A",
              "text-light": "#1F2937",
              "text-dark": "#FEFCE8",
              "text-muted-light": "#6b7280",
              "text-muted-dark": "#d1d5db",
            },
            fontFamily: {
              display: ["Plus Jakarta Sans", "sans-serif"],
            },
          },
        },
      };
    </script>
  </head>

  <body
    class="h-full font-display bg-background-light dark:bg-background-dark text-text-light dark:text-text-dark"
  >
    <div class="relative flex min-h-screen w-full flex-col overflow-x-hidden">
      <header
        class="sticky top-0 z-[1000] bg-background-light/80 dark:bg-background-dark/80 backdrop-blur-sm border-b border-primary/20 px-4 sm:px-8 md:px-16 lg:px-24 xl:px-40 py-4"
      >
        <div class="flex items-center justify-between whitespace-nowrap">
          <div class="flex items-center gap-3">
            <div class="size-6 text-primary">
              <svg
                fill="none"
                viewBox="0 0 48 48"
                xmlns="http://www.w3.org/2000/svg"
              >
                <path
                  d="M44 11.2727C44 14.0109 39.8386 16.3957 33.69 17.6364C39.8386 18.877 44 21.2618 44 24C44 26.7382 39.8386 29.123 33.69 30.3636C39.8386 31.6043 44 33.9891 44 36.7273C44 40.7439 35.0457 44 24 44C12.9543 44 4 40.7439 4 36.7273C4 33.9891 8.16144 31.6043 14.31 30.3636C8.16144 29.123 4 26.7382 4 24C4 21.2618 8.16144 18.877 14.31 17.6364C8.16144 16.3957 4 14.0109 4 11.2727C4 7.25611 12.9543 4 24 4C35.0457 4 44 7.25611 44 11.2727Z"
                  fill="currentColor"
                ></path>
              </svg>
            </div>
            <h2 class="text-xl font-bold leading-tight tracking-tighter">
              SurabayaCafeFinder
            </h2>
          </div>
          <nav class="hidden md:flex flex-1 justify-end">
            <div class="flex items-center gap-9">
              <a
                class="text-sm font-medium hover:text-primary transition-colors"
                href="index.html"
                >Beranda</a
              >
              <a
                class="text-sm font-medium hover:text-primary transition-colors"
                href="daftar_kafe.html"
                >Daftar Kafe</a
              >
              <a
                class="text-sm font-medium hover:text-primary transition-colors"
                href="about_page.html"
                >Tentang Kami</a
              >
            </div>
          </nav>
        </div>
      </header>

      <main class="flex-grow">
        <div class="flex flex-col min-h-[calc(100vh-80px)] lg:flex-row">
          <div
            class="w-full lg:w-[480px] lg:h-[calc(100vh-80px)] lg:sticky lg:top-20 flex flex-col p-6 border-r border-primary/20 bg-background-light dark:bg-background-dark"
          >
            <div class="relative mb-4">
              <span
                class="material-symbols-outlined absolute left-3 top-3 text-text-muted-light"
                >search</span
              >
              <input
                id="searchInput"
                class="w-full pl-10 pr-4 py-3 border border-primary/20 rounded-lg bg-white dark:bg-gray-800 focus:ring-2 focus:ring-primary focus:border-transparent outline-none transition-all"
                placeholder="Cari nama kafe atau area..."
              />
            </div>

            <div class="flex gap-4 mb-6">
              <button
                id="filterButton"
                class="flex-1 flex items-center justify-center gap-2 py-3 border border-primary/20 rounded-lg hover:bg-primary hover:text-white transition-all font-medium"
              >
                <span class="material-symbols-outlined text-sm"
                  >filter_list</span
                >
                Filter Area
              </button>
              <button
                id="sortButton"
                class="flex-1 flex items-center justify-center gap-2 py-3 border border-primary/20 rounded-lg hover:bg-primary hover:text-white transition-all font-medium"
              >
                <span class="material-symbols-outlined text-sm">star</span>
                Rating Tertinggi
              </button>
            </div>

            <h2 id="resultTitle" class="text-2xl font-bold mb-4 tracking-tight">
              Hasil Pencarian
            </h2>

            <div
              id="cafe-list"
              class="flex flex-col gap-4 overflow-y-auto pr-2"
            ></div>
          </div>

          <div class="flex-grow h-[500px] lg:h-auto p-4 lg:p-6 bg-secondary/10">
            <div id="map" class="shadow-xl border border-primary/10"></div>
          </div>
        </div>
      </main>

      <footer
        class="border-t border-primary/20 py-8 text-center text-sm text-text-muted-light dark:text-text-muted-dark bg-background-light dark:bg-background-dark"
      >
        © 2025 SurabayaCafeFinder. Hak Cipta Dilindungi.
      </footer>
    </div>

    <script src="https://unpkg.com/leaflet@1.9.4/dist/leaflet.js"></script>

    <script>
      let map;
      let markers = {};
      let cafeCardsRefs = [];

      const cafes = {
        "titik-koma": {
          name: "Titik Koma Coffee",
          position: [-7.3207, 112.7668],
          rating: 4.8,
          address: "Jl. Juwingan No.110, Surabaya Timur",
          detailUrl: "titik_koma.html",
        },
        kudos: {
          name: "Kudos Cafe",
          position: [-7.2885, 112.6694],
          rating: 4.6,
          address: "Pakuwon Square AK 2, Surabaya Barat",
          detailUrl: "kudos.html",
        },
        redback: {
          name: "Redback Specialty Coffee",
          position: [-7.2859, 112.7199],
          rating: 4.7,
          address: "Jl. Raya Darmo Permai III, Surabaya Barat",
          detailUrl: "redback.html",
        },
        "kopi-janji": {
          name: "Kopi Janji Jiwa",
          position: [-7.2756, 112.7421],
          rating: 4.5,
          address: "Jl. Basuki Rahmat, Surabaya Pusat",
          detailUrl: "kopi_janji.html",
        },
        tuku: {
          name: "Tuku Coffee",
          position: [-7.2893, 112.7349],
          rating: 4.7,
          address: "Jl. Raya Darmo, Surabaya Selatan",
          detailUrl: "tuku.html",
        },
        carpenter: {
          name: "Carpentier Kitchen",
          position: [-7.2846, 112.7381],
          rating: 4.6,
          address: "Jl. Untung Suropati, Surabaya Pusat",
          detailUrl: "carpentier.html",
        },
        historica: {
          name: "Historica Coffee",
          position: [-7.2918, 112.7342],
          rating: 4.8,
          address: "Jl. Sumatera, Surabaya Pusat",
          detailUrl: "historica.html",
        },
        simbiosis: {
          name: "Simbiosis Coffee",
          position: [-7.2899, 112.7218],
          rating: 4.6,
          address: "Jl. Raya Gubeng, Surabaya Timur",
          detailUrl: "simbiosis.html",
        },
        kalyan: {
          name: "Kopi Kalyan",
          position: [-7.2954, 112.7394],
          rating: 4.7,
          address: "Jl. Tunjungan, Surabaya Pusat",
          detailUrl: "kalyan.html",
        },
        noach: {
          name: "Noach Cafe & Bistro",
          position: [-7.2749, 112.7357],
          rating: 4.5,
          address: "Jl. Pregolan, Surabaya Barat",
          detailUrl: "noach.html",
        },
        luminary: {
          name: "Luminary Coffee",
          position: [-7.2794, 112.7153],
          rating: 4.6,
          address: "Citraland, Surabaya Barat",
          detailUrl: "luminary.html",
        },
        threelogy: {
          name: "Threelogy Coffee",
          position: [-7.2826, 112.7429],
          rating: 4.5,
          address: "Jl. Kayoon, Surabaya Pusat",
          detailUrl: "threelogy.html",
        },
        kenangan: {
          name: "Kopi Kenangan",
          position: [-7.2921, 112.7399],
          rating: 4.4,
          address: "Tunjungan Plaza, Surabaya Pusat",
          detailUrl: "kenangan.html",
        },
        common: {
          name: "Common Grounds",
          position: [-7.2608, 112.7436],
          rating: 4.7,
          address: "Pakuwon Mall, Surabaya Barat",
          detailUrl: "common_ground.html",
        },
        soematra: {
          name: "De Soematra 1910",
          position: [-7.2915, 112.7351],
          rating: 4.8,
          address: "Jl. Sumatera, Surabaya Pusat",
          detailUrl: "soematra.html",
        },
        nako: {
          name: "Kopi Nako",
          position: [-7.2703, 112.7211],
          rating: 4.6,
          address: "Surabaya Barat",
          detailUrl: "nako.html",
        },
        jungledome: {
          name: "Jungle Dome Cafe",
          position: [-7.2734, 112.7019],
          rating: 4.5,
          address: "Citraland, Surabaya Barat",
          detailUrl: "jungledome.html",
        },
        arabica: {
          name: "% Arabica",
          position: [-7.2584, 112.7428],
          rating: 4.7,
          address: "Pakuwon Mall, Surabaya Barat",
          detailUrl: "arabica.html",
        },
        libreria: {
          name: "Libreria Eatery",
          position: [-7.2912, 112.7307],
          rating: 4.6,
          address: "Jl. Ngagel Jaya, Surabaya Timur",
          detailUrl: "libreria.html",
        },
        delapangram: {
          name: "Delapan Gram Coffee",
          position: [-7.3001, 112.7265],
          rating: 4.5,
          address: "Jl. Manyar, Surabaya Timur",
          detailUrl: "delapangram.html",
        },
        kopicantik: {
          name: "Kopi Cantik",
          position: [-7.2839, 112.7094],
          rating: 4.4,
          address: "Surabaya Barat",
          detailUrl: "kopicantik.html",
        },
        kopisenja: {
          name: "Kopi Senja",
          position: [-7.2986, 112.7324],
          rating: 4.5,
          address: "Surabaya Selatan",
          detailUrl: "kopisenja.html",
        },
        pavilion: {
          name: "Pavilion Cafe",
          position: [-7.2867, 112.7369],
          rating: 4.6,
          address: "Jl. Pemuda, Surabaya Pusat",
          detailUrl: "pavilion.html",
        },
        kopitiam: {
          name: "Kopi Tiam Oey",
          position: [-7.2904, 112.7346],
          rating: 4.6,
          address: "Jl. Embong Malang, Surabaya Pusat",
          detailUrl: "kopitiam.html",
        },
        excelso: {
          name: "Excelso Coffee",
          position: [-7.2667, 112.7425],
          rating: 4.5,
          address: "Tunjungan Plaza, Surabaya Pusat",
          detailUrl: "excelso.html",
        },
        starbucks_tp: {
          name: "Starbucks Tunjungan Plaza",
          position: [-7.2659, 112.7429],
          rating: 4.6,
          address: "Tunjungan Plaza, Surabaya Pusat",
          detailUrl: "starbucks_tp.html",
        },
        starbucks_pakuwon: {
          name: "Starbucks Pakuwon Mall",
          position: [-7.2594, 112.7438],
          rating: 4.6,
          address: "Pakuwon Mall, Surabaya Barat",
          detailUrl: "starbucks_pakuwon.html",
        },
        djournal: {
          name: "Djournal Coffee",
          position: [-7.2662, 112.7431],
          rating: 4.7,
          address: "Tunjungan Plaza, Surabaya Pusat",
          detailUrl: "djournal.html",
        },
        anemos: {
          name: "Anemos Coffee",
          position: [-7.2964, 112.7427],
          rating: 4.6,
          address: "Jl. Darmo Permai, Surabaya Barat",
          detailUrl: "anemos.html",
        },
        satulima: {
          name: "Satu Lima Coffee",
          position: [-7.2831, 112.7234],
          rating: 4.5,
          address: "Jl. Manyar Kertoarjo, Surabaya Timur",
          detailUrl: "satulima.html",
        },
        kalosi: {
          name: "Kalosi Coffee",
          position: [-7.2815, 112.7169],
          rating: 4.6,
          address: "Jl. Dharmahusada, Surabaya Timur",
          detailUrl: "kalosi.html",
        },
        terace: {
          name: "Terace Coffee",
          position: [-7.2947, 112.7362],
          rating: 4.6,
          address: "Jl. Panglima Sudirman, Surabaya Pusat",
          detailUrl: "terace.html",
        },
      };

      /* DAFTAR 3 KAFE YANG SUDAH PUNYA HALAMAN DETAIL ASLI */
      const REAL_DETAIL = ["titik-koma", "kudos", "redback"];

      /* OTOMATIS ARAHKAN KAFE LAIN KE TEMPLATE AUTO */
      Object.keys(cafes).forEach((id) => {
        const c = cafes[id];
        if (!REAL_DETAIL.includes(id)) {
          c.detailUrl = "detail_auto.html?id=" + id;
        }
      });
    </script>

    <script>
      const cafeIcon = L.divIcon({
        className: "custom-marker",
        html: `<div style="background-color:#A16207;width:32px;height:32px;border-radius:50% 50% 50% 0;border:3px solid #FDE68A;transform:rotate(-45deg);display:flex;align-items:center;justify-content:center;box-shadow:0 4px 6px rgba(0,0,0,0.3);">
      <span style="color:#FDE68A;transform:rotate(45deg);font-size:16px;">☕</span>
    </div>`,
        iconSize: [32, 32],
        iconAnchor: [16, 32],
        popupAnchor: [0, -32],
      });

      function initMap() {
        map = L.map("map", { zoomControl: false }).setView([-7.27, 112.75], 12);
        L.control.zoom({ position: "bottomright" }).addTo(map);
        L.tileLayer("https://{s}.tile.openstreetmap.org/{z}/{x}/{y}.png", {
          attribution: "© OpenStreetMap contributors",
        }).addTo(map);
      }

      function renderCafeList() {
        const list = document.getElementById("cafe-list");
        list.innerHTML = "";
        cafeCardsRefs = [];

        Object.keys(cafes).forEach((id) => {
          const cafe = cafes[id];
          const card = document.createElement("div");
          card.className =
            "cafe-card p-4 rounded-lg border border-primary/10 bg-white dark:bg-gray-800 shadow-sm hover:shadow-md hover:border-primary/40 transition-all cursor-pointer group";
          card.dataset.id = id;
          card.innerHTML = `
            <div class="flex justify-between items-start">
                <h3 class="text-lg font-bold leading-tight group-hover:text-primary transition-colors">${cafe.name}</h3>
                <div class="flex items-center gap-1 bg-secondary/30 px-2 py-1 rounded-md">
                    <span class="material-symbols-outlined text-primary text-sm" style="font-variation-settings:'FILL' 1">star</span>
                    <span class="font-bold text-xs text-primary">${cafe.rating}</span>
                </div>
            </div>
            <p class="text-sm mt-2 text-text-muted-light dark:text-text-muted-dark flex items-center gap-1">
                <span class="material-symbols-outlined text-sm">location_on</span> ${cafe.address}
            </p>
        `;
          card.onclick = () => focusCafe(id);
          list.appendChild(card);
          cafeCardsRefs.push(card);
        });
        updateResultCount();
      }

      function renderMarkers() {
        Object.keys(cafes).forEach((id) => {
          const cafe = cafes[id];
          const marker = L.marker(cafe.position, { icon: cafeIcon }).addTo(map);
          const popupContent = `
            <div style="font-family:'Plus Jakarta Sans',sans-serif;padding:5px;">
                <h4 style="margin:0 0 5px 0;font-weight:800;color:#A16207;">${cafe.name}</h4>
                <p style="margin:0 0 10px 0;font-size:12px;color:#666;">${cafe.address}</p>
                <div style="display:flex;gap:5px;">
                    <button onclick="window.location.href='${cafe.detailUrl}'" style="background:#A16207;color:white;border:none;padding:5px 10px;border-radius:4px;cursor:pointer;font-size:11px;font-weight:bold;">Detail</button>
                    <button onclick="window.open('https://www.google.com/maps?q=${cafe.position[0]},${cafe.position[1]}','_blank')" style="background:white;color:#A16207;border:1px solid #A16207;padding:5px 10px;border-radius:4px;cursor:pointer;font-size:11px;">Rute</button>
                </div>
            </div>
        `;
          marker.bindPopup(popupContent);
          markers[id] = marker;
        });
      }

      function focusCafe(id) {
        const cafe = cafes[id];
        if (cafe && map) {
          map.setView(cafe.position, 16, { animate: true, duration: 1 });
          if (markers[id]) markers[id].openPopup();
        }
      }

      function updateResultCount() {
        const visible = cafeCardsRefs.filter(
          (c) => c.style.display !== "none"
        ).length;
        document.getElementById("resultTitle").textContent =
          "Hasil Pencarian (" + visible + ")";
      }

      document.addEventListener("DOMContentLoaded", () => {
        initMap();
        renderCafeList();
        renderMarkers();

        const searchInput = document.getElementById("searchInput");
        searchInput.addEventListener("input", function () {
          const q = this.value.toLowerCase();
          cafeCardsRefs.forEach((card) => {
            const cafe = cafes[card.dataset.id];
            const match =
              cafe.name.toLowerCase().includes(q) ||
              cafe.address.toLowerCase().includes(q);
            card.style.display = match ? "block" : "none";
          });
          updateResultCount();
        });

        document
          .getElementById("filterButton")
          .addEventListener("click", () => {
            const area = prompt(
              "Masukkan area (Timur, Barat, Pusat, Selatan):"
            );
            if (area === null) return;
            const qArea = area.toLowerCase();
            cafeCardsRefs.forEach((card) => {
              const cafe = cafes[card.dataset.id];
              const match = cafe.address.toLowerCase().includes(qArea);
              card.style.display = match ? "block" : "none";
            });
            updateResultCount();
          });

        document.getElementById("sortButton").addEventListener("click", () => {
          const list = document.getElementById("cafe-list");
          const sorted = [...cafeCardsRefs].sort((a, b) => {
            return cafes[b.dataset.id].rating - cafes[a.dataset.id].rating;
          });
          list.innerHTML = "";
          sorted.forEach((card) => list.appendChild(card));
        });
      });
    </script>
  </body>
</html>
